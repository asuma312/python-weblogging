{% extends "base/main_base.html" %}

{% block content %}
<script src="{{url_for('static', filename='js/dashboard.js')}}"></script>
  <div class="flex justify-between items-center mb-8">
                <h1 class="text-2xl font-semibold text-gray-900">Dashboard</h1>
                <div class="flex items-center space-x-4">
                    <button class="bg-white p-2 rounded-lg shadow">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-gray-500" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path stroke-linecap="round" stroke-linejoin="round" d="M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9" />
                        </svg>
                    </button>
                    <button class="bg-white p-2 rounded-full shadow">
                        <img src="https://images.unsplash.com/photo-1472099645785-5658abf4ff4e?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjEyMDd9&auto=format&fit=facearea&facepad=2&w=256&h=256&q=80" alt="Profile" class="h-8 w-8 rounded-full">
                    </button>
                </div>
            </div>

<div id="filter-container" class="mb-4">
  <label>Types (m√∫ltiplos):</label>
  <select id="typesSelect" multiple>
    <option value="info">info</option>
    <option value="warning">warning</option>
    <option value="error">error</option>
    <option value="debug">debug</option>
    <option value="critical">critical</option>
    <option value="success">success</option>
    <option value="failure">failure</option>
    <option value="all">all</option>
  </select>
  <label>Function Name:</label>
  <input type="text" id="functionNameInput" />
  <label>Data Start:</label>
  <input type="datetime-local" id="dataStartInput" />
  <label>Data End:</label>
  <input type="datetime-local" id="dataEndInput" />
  <button onclick="applyFilter()">Filtrar</button>
</div>

            <!-- Stats Grid -->
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
                <div class="bg-white rounded-lg shadow p-6">
                                      <div class="flex items-center justify-between">

                        <h3 class="text-gray-500 text-sm">Selected log</h3>
                    <select onchange="selectLog(this)" class="bg-white border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-auto p-2.5">
                        <option value="all">All</option>
                      {% for option in database_logs%}
                        <option value="{{ option }}" {% if option == selected_log %}selected{% endif %}>
                        {{ option }}</option>
                      {% endfor %}
                    </select>
                                      </div>
                </div>
                <div class="bg-white rounded-lg shadow p-6">
                    <div class="flex items-center justify-between">
                        <h3 class="text-gray-500 text-sm">Error Rate</h3>
                        <span class="bg-red-100 text-red-800 text-xs px-2 py-1 rounded-full">{{average_last_hour}}</span>
                    </div>
                    <p class="text-2xl font-semibold text-gray-900 mt-2">{{error_logs}}</p>
                </div>
            </div>

            <!-- Recent Logs Table -->
            <div class="bg-white rounded-lg shadow">
                <div class="px-6 py-4 border-b border-gray-200">
                    <h2 class="text-lg font-semibold text-gray-900">Recent Logs</h2>
                    <h2>Page: <span id="actualPage">{{ request.args.get('page',0)|int }}</span></h2>
                </div>
                <div class="overflow-x-auto">
                    <table class="min-w-full divide-y divide-gray-200">
                        <thead class="bg-gray-50">
                            <tr>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Timestamp</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Level</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Message</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Source</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Log</th>
                            </tr>
                        </thead>
                        <tbody class="bg-white divide-y divide-gray-200">
                        {% for key in logs.keys() %}
                            {% for row in logs[key] %}
                                <tr>
                                    {% for column in row %}
                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">{{ column }}</td>
                                    {% endfor %}
                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">{{ key }}</td>
                                </tr>
                            {% endfor%}
                        {% endfor %}
                        </tbody>
                    </table>
                </div>
<div class="flex justify-center items-center mt-4">
        {% if request.args.get('page',0)|int > 0 %}
    <button class="bg-blue-600 hover:bg-blue-700 text-white font-semibold px-6 py-2 rounded-lg shadow-md transition duration-300 ease-in-out transform hover:scale-105 m-4" onclick="gotoPrevPage()"><<</button>
    {% endif %}
    <button class="bg-blue-600 hover:bg-blue-700 text-white font-semibold px-6 py-2 rounded-lg shadow-md transition duration-300 ease-in-out transform hover:scale-105 m-4" onclick="gotoNextPage()">>></button>

</div>
            </div>

{% endblock %}